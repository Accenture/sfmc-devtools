# ### run npm install ###
echo "[POST-MERGE] ðŸ“¦ Checking for changes to dependencies"
# define how to split strings into array elements
IFS=$'\n'
# extract all paths to package-lock.json files
PACKAGE_LOCK_REGEX="(^package-lock\.json)"
echo "[POST-MERGE] running git diff --name-only HEAD^1 HEAD"
echo "[POST-MERGE] 0 $0"
echo "[POST-MERGE] 1 $1"
echo "[POST-MERGE] 2 $2"
echo "[POST-MERGE] 3 $3"
PACKAGES=$(git diff --name-only HEAD^1 HEAD | grep -E $PACKAGE_LOCK_REGEX || true)

if [[ ${PACKAGES[@]} ]]; then
  for package in $PACKAGES; do
    echo "ðŸ“¦ $package was changed."
  done
  echo "ðŸ“¦ Running npm install to update your dependencies..."
  npm install
  npm run lint:fix
else
  echo "ðŸ“¦ All packages up-to-date. No need to run npm install."
fi
